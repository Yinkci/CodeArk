!function(){var a={},b=function(b){for(var c=a[b],e=c.deps,f=c.defn,g=e.length,h=new Array(g),i=0;i<g;++i)h[i]=d(e[i]);var j=f.apply(null,h);if(void 0===j)throw"module ["+b+"] returned undefined";c.instance=j},c=function(b,c,d){if("string"!=typeof b)throw"module id must be a string";if(void 0===c)throw"no dependencies for "+b;if(void 0===d)throw"no definition function for "+b;a[b]={deps:c,defn:d,instance:void 0}},d=function(c){var d=a[c];if(void 0===d)throw"module ["+c+"] was undefined";return void 0===d.instance&&b(c),d.instance},e=function(a,b){for(var c=a.length,e=new Array(c),f=0;f<c;++f)e.push(d(a[f]));b.apply(null,b)},f={};f.bolt={module:{api:{define:c,require:e,demand:d}}};var g=c,h=function(a,b){g(a,[],function(){return b})};h("1",tinymce.PluginManager),h("b",tinymce),h("8",tinymce.util.Tools),h("c",document),g("6",["b","8","c"],function(a,b,c){var d={},e="codeMirrorLazyLoader",f=function(a,c,e){var f=e();b.each(d[a].callbacks,function(a){a(f)}),d[a]={module:f,callbacks:null}},g=function(b,g,h){var i=c.createElement("script");a[e]={define:f},d[b]={module:null,callbacks:[h]},i.src=g,c.body.appendChild(i)},h=function(a,b){var c=d[a];null===c.module?c.callbacks.push(b):b(c.module)},i=function(a,b,c){a in d?h(a,c):g(a,b,c)};return{load:i}}),h("5",tinymce.DOM),h("7",tinymce.util.Delay),h("9",tinymce.util.Promise),g("3",["6","5","7","8","9"],function(a,b,c,d,e){var f=function(a){var b;return b={lineWrapping:a.codemirror_linewrapping,lineNumbers:a.codemirror_linenumbers,foldGutter:a.codemirror_foldgutter,theme:a.codemirror_theme},a.codemirror_gutter===!1&&(b.gutters=[]),b},g=function(a,f,g,h){return new e(function(e){var i;i=d.extend({lineWrapping:!0,lineNumbers:!0,foldGutter:!0,matchTags:{bothTags:!0},keyMap:"sublime",gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{"Alt-F":"findPersistent","Ctrl-J":"toMatchingTag","Ctrl-B":"selectNextOccurrence","Ctrl-Q":function(a){a.foldCode(a.getCursor())}}},g,{value:h,mode:"text/html"});var j=a(function(a){f.appendChild(a)},i);b.bind(f,"keyup keydown keypress",function(a){27!==a.keyCode&&a.stopPropagation()}),c.setTimeout(function(){j&&(j.refresh(),j.focus())},100),e(j)})},h=function(c,d,f,h,i){return new e(function(e){b.styleSheetLoader.load(d),a.load("ephox.wrap.CodeMirror",c,function(a){g(a,f,i,h).then(e)})})};return{renderTo:h,fromTinySettings:f}}),h("a",tinymce.ui.Throbber),g("4",["a"],function(a){var b=function(a){a.statusbar.items().disabled(!1)},c=function(c,d){c.windowManager.open({title:d.title,body:d.body,buttons:[{text:"Ok",subtype:"primary",onclick:"submit",disabled:!0},{text:"Cancel",onclick:"close"}],onPostRender:function(){var c,e,f=this.getRoot();e=f.find("form > *")[0],c=new a(f.getEl("body")),c.show(1e3),d.onPostRender(e).then(function(){c.hide(),b(f)})},onSubmit:function(a){d.onSubmit(a.data)}})};return{show:c}}),g("2",["3","4","5"],function(a,b,c){var d=function(a,b){var c=a.codemirror_script;return c?c:b+"/codemirror.min.js"},e=function(a,b){var c=a.codemirror_css;return c?c:b+"/codemirror.min.css"},f=function(f,g){var h,i=function(b){var c,i,j,k;return j=d(f.settings,g),k=e(f.settings,g),c=b.getEl("body"),i=f.getContent({source_view:!0}),a.renderTo(j,k,c,i,a.fromTinySettings(f.settings)).then(function(a){h=a})},j=function(){f.focus(),f.undoManager.transact(function(){f.setContent(h.getValue())}),f.selection.setCursorLocation(),f.nodeChanged()};b.show(f,{title:"Source code",body:{type:"panel",border:1,classes:"codemirror",minWidth:f.getParam("code_dialog_width",600),minHeight:f.getParam("code_dialog_height",Math.min(c.getViewPort().h-200,500))},onPostRender:i,onSubmit:j})};return{show:f}}),g("0",["1","2"],function(a,b){var c=function(a,c){return function(){b.show(a,c)}},d=function(a,b){return a.addCommand("mceCodeEditor",c(a,b)),a.addButton("code",{icon:"code",tooltip:"Source code",onclick:c(a,b)}),a.addMenuItem("code",{icon:"code",text:"Source code",context:"tools",onclick:c(a,b)}),{}};return a.add("advcode",d),function(){}}),d("0")()}();